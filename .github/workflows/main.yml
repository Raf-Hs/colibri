name: k6 Load Test

on:
  pull_request:
    branches:
      - main
      - development

jobs:
  load-test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4

    # ðŸŸ¢ CORRECCIÃ“N FINAL: Usamos el tag 'v0' para obtener la Ãºltima versiÃ³n estable.
    - name: Run k6 load test
      uses: grafana/k6-action@v0
      with:
        # La ruta de tu script:
        script: test/load-test.js

      env:
        # El token de Cloud:
        K6_CLOUD_TOKEN: ${{ secrets.GRAFANA_CLOUD_K6_TOKEN_DIEGO }}
        # Si implementaste la seguridad:
        K6_ENV_EMAIL: ${{ secrets.USER }}
        K6_ENV_PASSWORD: ${{ secrets.PASS }}

name: k6 Load Test

on:
  pull_request:
    branches:
      - main
      - development

jobs:
  load-test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4

    - name: Run k6 load test
      uses: grafana/run-k6-action@v1.2.0 
      with:        
        path: colibri/test/load-test.js 

      env:
        # K6_CLOUD_TOKEN gestiona la salida a Cloud por defecto cuando est√° presente
        K6_CLOUD_TOKEN: ${{ secrets.GRAFANA_CLOUD_K6_TOKEN_DIEGO }}
